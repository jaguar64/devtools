{\rtf0\pc\deff709{\fonttbl{\f709\fnil Bitstream Charter Black;}{\f648\fnil Bitstream Charter;}{\f14\fnil Dutch;}}\nofpages11\deftab720\paperw11520\paperh15263\margl1440\margr1440\margt1080\margb1080\pgnstart1\pgndec\sectd\cols1{\footer\f709\fs20 \chpgn 	ab}\headery720\footery360 \pard\qc\fi0\li0\ri-10\plain\f709\fs22 The Jaguar Synth\par\pard\ql\fi0\li0\ri-10\plain\f709\fs22 \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 Sound in Jaguar is produced by the Digital Signal Processor (DSP) in Jerry. This requires a synthesizer program running in the DSP. This document describes the lowest level interface to one such program, FULSYN.\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 There are eight synthesis modules:\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 3 Sampler modules.\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 3 FM Modules.\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 A Wavetable module.\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 A Waveform with envelope module\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 All seven of the modules can be placed at a stereo pan location.\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 The Sampler modules allows 8 or 16 bit signed sample data as well as 16 bit data that has been compressed 2:1. The compression is slightly lossy, the compression is done by the program sndcomp. All Samplers use data that is not in Jerry's internal RAM.  All samplers also support pitch shifting. The Samplers have the ability to loop within the sample so that long sustains may be achieved without using too much memory. The parameters for the Sampler modules are:\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pitch\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Loop flag/Volume\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pointer to sample data\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 End of loop\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Size of loop\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pan value\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 The FM modules are simple to understand but produce a wide variety of sounds. In simple terms an FM synthesizer takes a 128 sample waveform where each sample consists of a 16 bit signed integer sign extended to a 32 bit long. The synth then modulates the frequency according to another waveform (built like the first). The simple FM parameters are:\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pitch\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Volume\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pointer to Sample Waveform\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pointer to Modulating Waveform\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Frequency of modulation\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Depth of modulation\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pan Value\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 The complex FM module adds:\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pointer to Modulator of Modulation\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Frequency of modulation of frequency\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Depth of modulation of frequency\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Frequency of modulation of depth\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Depth of modulation of depth\par\pard\ql\fi0\li0\ri6\plain\f648\fs22 \par\pard\ql\fi0\li0\ri6\plain\f648\fs22 All envelope handling is done outside of the DSP by adjusting the volume of each voice.\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 The wavetable synth uses a conceptually complex synthesis technique that offers a very wide degree of flexibility of sound with a modest computational overhead. The wavetable synth plays a set of instructions. An instruction defines a waveform, a time, a volume change, a fade time and a next instruction. The waveforms consist of 128 samples, each sample is a 16 bit signed integer sign extended to a long. The waveforms are 512 bytes long and \f709 must\f648  start on a 512 byte boundary. The instructions may loop to form a sustain. Much of the flexibility of the wavetable synth is derived from the fact that as the synth switches from one instruction to the next the output waveform is the linear interpolation between the waveforms in the two instructions.\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 The parameters for the wave table synth are:\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pitch\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Release Flag\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Volume\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pointer to first Instruction\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pointer to Release Instruction\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Sample Length (2^N size)\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pan Value\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 The Instructions contain:\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pointer to sample\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Number of ticks to play the sample\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Number of ticks to fade to next sample\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Amplitude fade\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pointer to next Instruction\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 The wavetable amplitude fade control acts like a built-in envelope.\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 The Waveform module allows any 128 sample waveform (as defined for the wavetable synth) to be played to the DACs at any musical pitch. The volume of this is then modulated by what may be thought of as a very slow sample as an envelope. This envelope has the ability to loop so that long sustains may be achieved without using too much memory. The parameters for the waveform module are:\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pointer to Waveform\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pointer to Envelope\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pitch\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Loop flag\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Volume\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Envelope rate\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 End of loop\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Size of loop\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Pan value\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 The last FM module, called the FM/Env synth combines the Simple FM wave generation with the Waveform synth envelope generation.\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 To use the synth follow these steps:\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 1) Load the synth code into the DSP.\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 2) Initialize some locations in DSP RAM.\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 3) Initialize the DAC and start the DSP.\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 4) Set up a "Voice Table".\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 5) Start the voice.\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 6) Turn off voices as required\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 7) Repeat from (4).\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 Voice Tables are stored in DSP RAM. \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 The DSP code, and all its internal variables, are in the bottom of DSP RAM. This allows TABLESTART (the start of the Voice Tables) to be quite low in DSP RAM (TABLESTART is a define, use it as the position may change). The size of the table at TABLESTART is not defined in the synth itself, it is determined by the programmer at run time (see table below). The remainder of DSP RAM should be used to store the following, (a) Custom samples for both wavetable and FM synthesis, (b) Voice Tables, these must be contiguous with TABLESTART ,(c) Wave Table instructions and (d) Waveform envelopes. Other uses for DSP RAM may arise as new synthesis modules are written. Each Voice Table starts with a long (32 bit) that indicates if the voice is active or not. The legal values are:\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 0\tab End of active voices\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 -4\tab Skip this voice\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 4\tab FM/Env\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 8\tab Simple FM\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 12\tab 16 bit Sampler\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 16\tab Complex FM\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 20\tab 2^n wavetable\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 24\tab Waveform/Envelope\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 28\tab 8 bit Sampler\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 32\tab Compressed Data Sampler\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 The values in the rest of the Voice table are given in the following pages. In the tables that follow, the symbol  » means this value may be changed while the note is active. Values not specified do not need to be set. The end of the Table list is indicated by a 0 where the next table would start.\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 When doing polyphonic synthesis (more than one note at a time), the volume of each voice \f709 must\f648  be reduced to avoid overflow. For example a single loud voice would have a volume of about $6000. Adding 3 of these would overflow 16 bits. To avoid this you must scale down the volume of each voice such that the total fits into 16 bits. In the preceding example a reduction of about 3 would work.\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 The values to use for pitch are given in the accompanying spreadsheet. Find the note that you want the value for. The values for the FM synths and the wavetable synth are in the column marked (64K) for the other modules the value to use is in the column (256).\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 \par\pard\ql\fi0\li0\ri6\plain\f648\fs22 The synth has a certain amount of time available to synthesize each sample, during that time it can do only so much. The total time available is 168 time units (these are not clock ticks). The following is a list of the approximate number of time units used by each synth module:\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Simple FM\tab \tab ~15 time units\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Complex FM\tab \tab ~24 time units\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 FM/Env\tab \tab ~23 time units\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Samplers\tab \tab ~19 time units\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Wave Table\tab \tab ~18 time units\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Waveform synth\tab ~19 time units\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Skip a voice\tab \tab ~3 time units\par\pard\ql\fi0\li0\ri6\plain\f648\fs22 \par\pard\ql\fi0\li0\ri6\plain\f648\fs22 These numbers may change as the synth modules are modified and optimized. The timings above assume that all table and sample data are in internal DSP memory (except for sample used by the Sampler module). The numbers given for the Sampler modules assume that the main bus is not busy doing other things. The total number of time units used can be computed from these numbers and kept below 167. The number available can be read from a location in DSP RAM called TIMELEFT.\par\pard\ql\fi0\li0\ri6\plain\f648\fs22 \par\pard\ql\fi0\li0\ri6\plain\f648\fs22 Note: The 168 time units will reduce if oversampling is added to the synth.\par\pard\ql\fi0\li0\ri6\plain\f648\fs22 \par\pard\ql\fi0\li0\ri6\plain\f648\fs22 The above timings assume that the synth is running at the default rate of ~20kHz. This can be changed by modifying the value stored in SCLK. If this is done then all of the pitch information will need to be modified.\par\pard\ql\fi0\li0\ri6\plain\f648\fs22 \par\pard\ql\fi0\li0\ri6\plain\f709\fs22 Simple FM Module\par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3590\plain\f709\fs22 \tab OFFSET (longs)\tab Description\par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3622\plain\f709\fs22 \par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3622\plain\f648\fs22 \tab 0\tab Voice type (8)\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 1\tab Pointer to Carrier Wave. Must be on a long (32 bit) boundary  (should be DSP memory for speed). »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 2\tab Pointer to Modulating Wave. Must be on a long (32 bit) boundary (should be DSP memory for speed). »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 3\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 4\tab Pitch. Given as the size of a step in samples as a 15.16 number. »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 5\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 6\tab Volume of this voice, 15 bits.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 7\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 8\tab Frequency of Modulation. Given as the size of a step in samples as a 15.16 number.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 9\tab Depth of modulation. This is a 7.8 number.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 19\tab Pan Value. 0 is full right, $3fff is balanced, $7fff is full left.  »\par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3590\plain\f709\fs22 Complex FM synth\par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3590\plain\f709\fs22 \tab OFFSET (longs)\tab Description\par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3622\plain\f709\fs22 \par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3622\plain\f648\fs22 \tab 0\tab Voice type (16)\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 1\tab Pointer to Carrier Wave. Must be on a long (32 bit) boundary in internal DSP memory. »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 2\tab Pointer to Modulating Wave. Must be on a long (32 bit) boundary in internal DSP memory. »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 3\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 4\tab Pitch. Given as the size of a step in samples as a 15.16 number.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 5\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 6\tab Volume of this voice, 15 bits.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 7\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 8\tab Frequency of Modulation. Given as the size of a step in samples as a 15.16 number.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 9\tab Depth of modulation. This is a 7.8 number.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 10\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 11\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 12\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 13\tab Frequency of modulation of frequency. Given as the size of a step in samples as a 15.16 number.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 14\tab Depth of modulation of frequency. This is a 7.8 number.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 15\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 16\tab Frequency of modulation of depth. Given as the size of a step in samples as a 15.16 number.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 17\tab Depth of modulation of depth. As a 7.8 number.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 19\tab Pan Value. 0 is full right, $3fff is balanced, $7fff is full left.  »\par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3590\plain\f709\fs22 Sampler Module\par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3590\plain\f709\fs22 \tab OFFSET (longs)\tab Description\par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3622\plain\f709\fs22 \par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3622\plain\f648\fs22 \tab 0\tab Voice type \par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3622\plain\f648\fs22 \tab \tab (12, 16 bit; 28, 8 bit; 32, compressed 16 bit)\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 1\tab High bit is the loop flag. The low 15 bits are the volume.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 2\tab Pointer to Sample. Must be on a word (sample size) boundary outside of internal DSP memory.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 3\tab Pitch. Given as the size of a step in samples as a 23.8 number.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 4\tab End of loop in samples as a 23.8 number. For a non-looping sample this is the sample number at end of the sample. When the current pointer passes this point the Voice type is set to -1. For a looped sample this is end point of the loop. This is given in samples as an integer with no fractional part.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 5\tab Loop length in samples. This is a 23.8 number.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 6\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 19\tab Pan Value. 0 is full right, $3fff is balanced, $7fff is full left.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\tx3622\plain\f648\fs22 Looping works like this. Assume a sample in memory. There are four points of interest.\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 The start of the sample.\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 The beginning of the loop.\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 The end of the loop.\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 The end of the sample.\par\pard\ql\fi0\li0\ri-10\tx3622\plain\f648\fs22 To play a looped sample:\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Turn on the loop flag.\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Set the End Loop to the end of the loop. (In samples)\par\pard\ql\fi16\li708\ri6\plain\f648\fs22 Set the loop length (in samples) so that Loop End - Loop length = beginning of the loop.\par\pard\ql\fi0\li0\ri6\plain\f648\fs22 This will play the sample until the loop point and then loop. To stop looping, set the End loop to the end of the sample (in samples) and clear the loop flag. At the end of a sample the voice type is set to -1 by the synth. This allows the voice to be skipped. The voice may be reused at this point.\par\pard\ql\fi0\li0\ri6\plain\f648\fs22 \par\pard\ql\fi0\li0\ri6\plain\f709\fs22 2^N Wave Table\par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3590\plain\f709\fs22 \tab OFFSET (longs)\tab Description\par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3622\plain\f709\fs22 \par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3622\plain\f648\fs22 \tab 0\tab Voice type (20)\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 1\tab Volume of this voice as a 15 bit number. This is the maximum volume reached by the voice.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 2\tab The high bit is the release flag. The remaining bits are the pitch as the size of a step in samples as a 23.8 number.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 3\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 4\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 5\tab Pointer to release instruction. May be anywhere in memory on a long (32 bit) boundary. For performance reasons it should be in DSP RAM. \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 6\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 7\tab Size of wavetable sample. This 23.8 number is 2^n-1.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 8\tab Reset to Zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 9\tab Reset to Zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 10\tab Pointer to the first instruction. May be anywhere in memory on a long (32 bit) boundary. For performance reasons it should be in DSP RAM. At the end of the release sequence this is set to -1.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 19\tab Pan Value. 0 is full right, $3fff is balanced, $7fff is full left.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 After the release sequence completes, the pointer at offset 10 is set to -1 to indicate that the voice may be reused.\par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\plain\f648\fs22 Wavetable Instructions are a list of longs:\par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3590\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3590\plain\f648\fs22 \tab \f709 OFFSET\tab Description\par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3622\plain\f709\fs22 \par\pard\ql\fi-3606\li3606\ri-10\tqc\tx-3103\tx16\plain\f648\fs22 \tab 0\tab Pointer to sample to be played. Must be on a \f709 512\f648  byte boundary. For performance should be it should be in internal DSP memory.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 1\tab Unused.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 2\tab Time. Length of time, in ticks to play this sample.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 3\tab Fade value. This value sets the amplitude change per tick of fade. A becomes A*n, where n is a scaled 15 bit number n= $4000 is no change n=$2000 is divide volume by two etc.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 4\tab Fade length. The length of the fade given as N where the fade lasts 2^(N-1) ticks. 2<=N<=14.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 5\tab Pointer to next instruction. May be anywhere in memory on a long (32 bit) boundary. For performance reasons it should be in DSP RAM. This should be set to -1 to indicate the end of the voice.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3590\plain\f709\fs22 Waveform Module\par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3590\plain\f709\fs22 \tab OFFSET (longs)\tab Description\par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3622\plain\f709\fs22 \par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3622\plain\f648\fs22 \tab 0\tab Voice type (24)\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 1\tab Pointer to Waveform. Must be on \f709 512\f648  byte boundary. For performance it should be in internal DSP memory  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 2\tab Pointer to Envelope. Must be on a long (32 bit) boundary. For performance it should be in internal DSP memory. »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 3\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22  \tab 4\tab Pitch given as the step size, in samples as a 15.16 number. »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 5\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 6\tab Loop flag is the high bit, the rest is the overall volume as a 15 number. »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 7\tab Envelope rate, given as the step size, in samples as a 15.16 number. »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 8\tab End of loop in samples as a 15.16 number. For a non-looping sample this is the sample number at end of the sample. When the current pointer passes this point the Voice type is set to -1. For a looped sample this is end point of the loop. This is given in samples as an integer with no fractional part.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 9\tab Loop length in samples. This is a 15.16 number.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 19\tab Pan Value. 0 is full right, $3fff is balanced, $7fff is full left.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi0\li0\ri-10\tx3622\plain\f648\fs22 Note: See the discussion on looping for the Sampler module.\par\pard\ql\fi0\li0\ri6\plain\f709\fs22 FM/ENV Module\par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3590\plain\f709\fs22 \tab OFFSET (longs)\tab Description\par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3622\plain\f709\fs22 \par\pard\ql\fi0\li0\ri-10\tqc\tx503\tx3622\plain\f648\fs22 \tab 0\tab Voice type (4)\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 1\tab Pointer to Carrier Wave. Must be on a long (32 bit) boundary  (should be DSP memory for performance). »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 2\tab Pointer to Modulating Wave. Must be on a long (32 bit) boundary (should be DSP memory for performance). »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 3\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 4\tab Pitch. Given as the size of a step in samples as a 15.16 number. »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 5\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 6\tab High bit is the loop flag. the low 15 bits are the volume.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 7\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 8\tab Frequency of Modulation. Given as the size of a step in samples as a 15.16 number.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 9\tab Depth of modulation. This is a 7.8 number.  »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 10\tab Pointer to Envelope. Must be on a long (32 bit) boundary (should be DSP memory for performance). »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 11\tab Envelope rate given as the size of a step in samples as a  15.16 form. »\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 12\tab End of loop in samples as a 15.16 number.»\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 13\tab Loop Length in samples as a 15.16 bit number.»\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 14\tab Reset to zero.\par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \par\pard\ql\fi-3638\li3638\ri-10\tqc\tx-3135\tx-16\plain\f648\fs22 \tab 19\tab Pan Value. 0 is full right, $3fff is balanced, $7fff is full left.  »\par\pard\ql\fi0\li0\ri-10\tx3622\plain\f648\fs22 Note: See the information on looping for the Sampler module.\sect}